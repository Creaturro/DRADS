---
import MainLayout from "../../layouts/MainLayout.astro";
import ReusableSection from "../../components/sections/misc/ReusableSection.astro";
import PrimaryCTA from "../../components/ui/buttons/PrimaryCTA.astro";
import SecondaryCTA from "../../components/ui/buttons/SecondaryCTA.astro";
import caseStudies from "../../data_files/case-studies.json";

export async function getStaticPaths() {
  return caseStudies.map(cs => ({ params: { id: cs.id.toString() } }));
}

const { id } = Astro.params;
const caseStudy = caseStudies.find(cs => cs.id === parseInt(id));
if (!caseStudy) {
  return Astro.redirect('/404');
}
---

<MainLayout>
  <!-- Hero Section -->
  <section class="relative py-20 bg-gradient-to-b from-third to-neutral-900">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="text-center">
        <div class="flex items-center justify-center gap-4 mb-6">
          <span class="px-4 py-2 bg-primary/20 text-primary rounded-full text-sm font-semibold">
            {caseStudy.industry}
          </span>
          <span class="text-neutral-400 font-h4">{caseStudy.client}</span>
        </div>
        <h1 class="font-h2 mb-6">
          {caseStudy.title}
        </h1>
        <p class="font-h3 max-w-3xl mx-auto">
          {caseStudy.description}
        </p>
      </div>
    </div>
  </section>

  <!-- Project Overview -->
  <ReusableSection 
    title="Project Overview" 
    description="A comprehensive look at the challenges, solutions, and results of this transformation"
  >
    <div slot="leftContent">
      <div class="space-y-8">
        <div>
          <h3 class="font-h4 mb-4 text-primary">The Challenge</h3>
          <p class="text-neutral-300">{caseStudy.challenge}</p>
        </div>
        
        <div>
          <h3 class="font-h4 mb-4 text-primary">Our Solution</h3>
          <p class="text-neutral-300">{caseStudy.solution}</p>
        </div>
        
        <div>
          <h3 class="font-h4 mb-4 text-primary">Technologies Used</h3>
          <div class="flex flex-wrap gap-2">
            {caseStudy.technologies.map((tech: string) => (
              <span class="px-3 py-1 bg-secondary/20 text-secondary rounded-full text-sm">
                {tech}
              </span>
            ))}
          </div>
        </div>
      </div>
    </div>
    
    <div slot="rightContent">
      <div class="space-y-8">
        <div class="bg-third rounded-xl p-6 border border-neutral-700">
          <h3 class="font-h4 mb-6 text-center">Key Results</h3>
          <div class="grid grid-cols-1 gap-6">
            {Object.entries(caseStudy.metrics).map(([key, value]) => (
              <div class="text-center p-4 bg-neutral-800 rounded-lg">
                <div class="text-3xl font-bold text-primary mb-2">{value}</div>
                <div class="text-sm text-neutral-400 capitalize">{key}</div>
              </div>
            ))}
          </div>
        </div>
        
        <div class="bg-third rounded-xl p-6 border border-neutral-700">
          <h3 class="font-h4 mb-4">Project Details</h3>
          <div class="space-y-3 text-sm">
            <div class="flex justify-between">
              <span class="text-neutral-400">Industry:</span>
              <span class="text-neutral-100">{caseStudy.industry}</span>
            </div>
            <div class="flex justify-between">
              <span class="text-neutral-400">Client:</span>
              <span class="text-neutral-100">{caseStudy.client}</span>
            </div>
            <div class="flex justify-between">
              <span class="text-neutral-400">Technologies:</span>
              <span class="text-neutral-100">{caseStudy.technologies.length}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ReusableSection>

  <!-- Detailed Description -->
  <section class="py-16 bg-neutral-800">
    <div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
      <h2 class="font-h2 mb-8 text-center">Project Details</h2>
      <div class="prose prose-invert max-w-none">
        <p class="font-h3 text-neutral-300 leading-relaxed">
          {caseStudy.longDescription}
        </p>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 bg-gradient-to-r from-primary/10 to-secondary/10">
    <div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="font-h2 mb-6">Ready to Start Your Project?</h2>
      <p class="font-h3 mb-8 text-neutral-300">
        Let's discuss how DRADS can transform your business with custom software solutions tailored to your specific needs.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <PrimaryCTA title="Get Custom Quote" url="/contact" />
        <SecondaryCTA title="View All Projects" url="/case-studies" />
      </div>
    </div>
  </section>
</MainLayout> 